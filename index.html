<html>
  <head>
    <title>McQueen feat. Witkin</title>
    <meta charset="utf-8" />
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="author" content="ARTOLDO - Sara Ferro & Chris Weil">
    <meta property="og:image" content="./images/mask.png" />
    <link rel="icon" type="image/png" href="./images/mask.png" />
    <script src="assets/engine.js"></script>
    <script src="assets/extras.js"></script>
    <script src="assets/sound.js"></script>
    <script src="assets/audio.js"></script>
    <script src="assets/rain.js"></script>
    <script src="assets/loader1.js"></script>
    <script src="assets/loader2.js"></script>
    <script src="assets/gui.js"></script>
    <script src="assets/lock-pitch.js"></script>

    <!-- Link to external CSS -->
    <link rel="stylesheet" type="text/css" href="assets/lightbox.css" />

    <style>
      .a-dialog-allow-button {
       background-color: white;
	}

      .a-dialog-deny-button {
       background-color: white;
        }

      .a-dialog-ok-button {
       background-color: white;
        }

      .mask {
      z-index: 99;
      width: 250px;
      height: 209px;
      position: absolute;
  
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      }

      img {
      -webkit-user-drag: none;
      user-drag: none;         
      -webkit-user-select: none;
      -moz-user-select: none;    
      -ms-user-select: none;    
      user-select: none;        
      }

      .no-js #loader { display: none;  }
      .js #loader { display: block; position: absolute; left: 100px; top: 0; }
      .se-pre-con {
	position: fixed;
	left: 0px;
	top: 0px;
	width: 100%;
	height: 100%;
	z-index: 9999;
	background: url(./images/spinner.svg) center no-repeat #000;
     }
  
    </style>
  </head>

<script>
// Wait for window load
	$(window).load(function() {
		// Animate loader off screen
		$(".se-pre-con").fadeOut("slow");;
	});
</script>

<script>
document.querySelectorAll('img').forEach((img) => {
    img.addEventListener('dragstart', (e) => e.preventDefault());
});
</script>

<body style="background-color:red">

<div class="se-pre-con"></div>


<!-- Mask -->

<img src="images/mask.webp" class="mask" draggable="false" style="cursor:pointer;"/>

<!-- Mask -->

<script>
    document.querySelector('.mask').addEventListener('click', function () {
      const canvasEl = document.querySelector('a-scene').canvas;

      // Request pointer lock on the canvas (A-Frame scene)
      if (canvasEl.requestPointerLock) {
        canvasEl.requestPointerLock();
      } else if (canvasEl.mozRequestPointerLock) {
        canvasEl.mozRequestPointerLock();
      }

      // Enable pointer lock in the A-Frame look-controls component
      const cameraEl = document.querySelector('[camera]');
      const lookControls = cameraEl.components['look-controls'];
      if (lookControls) {
        lookControls.data.pointerLockEnabled = true;
        console.log('Pointer Lock Enabled');
      }
    });
</script>


<a-scene rain="width: 100; count: 10000;" loading-screen="dotsColor: red; backgroundColor: red" vr-mode-ui="enabled: false" 
device-orientation-permission-ui="enabled: true" antialias="true" cursor="rayOrigin: mouse">


<!-- World -->

<a-sky color="#000"></a-sky>

<a-cylinder material="src:images/cylinder1.webp; side: double;" open-ended="true" scale="80 50 80" opacity="0.6;" position="0 22.7 0" rotation="0 0 0" animation="property: rotation; to: 0 -360 0; loop: true; easing: linear; dur: 20000"></a-cylinder>

<a-cylinder material="src:images/cylinder2.webp; side: double;" open-ended="true" scale="80 50 80" opacity="0.3;" position="0 22.7 0" rotation="0 0 0" animation="property: rotation; to: 0 360 0; loop: true; easing: linear; dur: 20000"></a-cylinder>

<a-plane id="red carpet 1" width="12" height="17" color="red" position="11 0.1 -7" rotation="-90 90 0"></a-plane>

<a-plane id="red carpet 2" width="12" height="17" color="red" position="-11 0.1 -7" rotation="-90 90 0"></a-plane>

<a-plane id="red carpet 3" width="14" height="17" color="red" position="11 0.1 10" rotation="-90 90 0"></a-plane>

<a-plane id="red carpet 4" width="14" height="17" color="red" position="-11 0.1 10" rotation="-90 90 0"></a-plane>

<a-image src="./images/shirts.webp" position="0 13.5 -15" width="14" height="7" rotation="25 0 0" animation="property:rotation; to: 0 0 0; easing: easeOutQuad; dir: alternate; loop: true; dur: 4000;">
</a-image>

<!-- World End -->


<!-- Camera -->

<a-entity id="rig" position="0 5 0" look-controls="pointerLockEnabled:true;" lock-pitch animation="property: position; to: 0 3 0; easing: linear; dur: 1000">

<a-entity id="camera" camera position="0 1.6 0" cursor-visible="true">

<a-gui-cursor id="cursor"
raycaster="objects: [gui-interactable]"
fuse="true" fuse-timeout="1000"
color="white"
hover-color="white"
active-color="white"
design="dot">
</a-gui-cursor>

</a-entity>

</a-entity>

<!-- Camera End -->


<!-- Music -->

<audio id="music" src="assets/music.mp3" crossorigin="anonymous"></audio>

<a-box color="black" scale="2 2 2" position="0 -2 0" audio="src: #music; loop: true;"></a-box>

<!-- Music End -->


<!-- Sound -->

<audio id="sound1" src="assets/mcqueen.mp3" preload="auto" crossorigin="anonymous"></audio>
<audio id="sound2" src="assets/witkin.mp3" preload="auto" crossorigin="anonymous"></audio>
<audio id="sound3" src="assets/mcgirr.mp3" preload="auto" crossorigin="anonymous"></audio>
<audio id="sound4" src="assets/dante.mp3" preload="auto" crossorigin="anonymous"></audio>
<audio id="sound5" src="assets/bowie.mp3" preload="auto" crossorigin="anonymous"></audio>
<audio id="sound6" src="assets/west.mp3" preload="auto" crossorigin="anonymous"></audio>
<audio id="sound7" src="assets/lagerfeld.mp3" preload="auto" crossorigin="anonymous"></audio>
<audio id="sound8" src="assets/prada.mp3" preload="auto" crossorigin="anonymous"></audio>

<!-- Sound End -->


<!-- Stage -->


<a-entity text="value:McQueen feat. Witkin; color:#ffffff; shader: msdf; font: assets/fonts/cinzeldecorative/CinzelDecorative-Bold.json; align:center;" position="0 8.8 -13.5" scale="21 21 21"></a-entity> 

<a-assets>
  <video id="video1" src="assets/mcqueen.mp4" autoplay muted loop></video>
</a-assets>

<a-video gui-interactable id="sound01" sound="src: #sound1; on: click; autoplay: false;" src="#video1" position="-8 4.5 -10" width="3.168" height="4" rotation="0  50 0" opacity="0.9"
animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200";
animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200";>
</a-video>

</a-plane>

<a-plane gui-interactable id="sound02" sound="src: #sound2; on: click; autoplay: false;" width="3.168" height="4" position=" 8 4.5 -10" material="src:images/witkin.webp; transparent: true" rotation="0 -50 0"
             animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200";
             animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200";>
</a-plane>

<a-plane gui-interactable id="sound03" sound="src: #sound3; on: click; autoplay: false;" width="3.168" height="4" position="-9 4.5 -6" material="src:images/mcgirr.webp; transparent: true" rotation="0  90 0"
             animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200";
             animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200";>
</a-plane>

<a-plane gui-interactable id="sound04" sound="src: #sound4; on: click; autoplay: false;" width="3.168" height="4" position=" 9 4.5 -6" material="src:images/dantemask.webp; transparent: true" rotation="0 -90 0"
             animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200";
             animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200";>
</a-plane>

<a-plane gui-interactable id="sound05" sound="src: #sound5; on: click; autoplay: false;" width="3.168" height="4" position="-9 4.5 -2" material="src:images/bowie.webp; transparent: true" rotation="0  90 0" 
             animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200";
             animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200";>
</a-plane>

<a-plane gui-interactable id="sound06" sound="src: #sound6; on: click; autoplay: false;" width="3.168" height="4" position=" 9 4.5 -2" material="src:images/west.webp; transparent: true" rotation="0 -90 0" 
             animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200";
             animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200";>
</a-plane>

<a-plane gui-interactable id="sound07" sound="src: #sound7; on: click; autoplay: false;" width="3.168" height="4" position="-9 4.5 2" material="src:images/prada.webp; transparent: true" rotation="0  90 0" 
             animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200";
             animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200";>
</a-plane>

<a-plane gui-interactable id="sound08" sound="src: #sound8; on: click; autoplay: false;" width="3.168" height="4" position=" 9 4.5 2" material="src:images/west.webp; transparent: true" rotation="0 -90 0" 
             animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200";
             animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200";>
</a-plane>

<a-plane 
        gui-interactable 
        id="models" 
        lightbox 
        data-url="models.html" 
        width="8" 
        height="4.5" 
        position="-8.5 3 8" 
        material="src:images/models1.webp; transparent: true" 
        rotation="0 160 0" 
        animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200"
        animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
</a-plane>

<!-- Stage End -->


<!-- Models -->

<a-assets>
<a-asset-item id="model1" src="./images/modelwalking1.glb"></a-asset-item>
<a-asset-item id="model2" src="./images/modelwalking2.glb"></a-asset-item>
<a-asset-item id="model3" src="./images/modelspray.glb"></a-asset-item>
<a-asset-item id="robot" src="./images/robot.glb"></a-asset-item>
</a-assets>

<a-entity position="0 -1 -30" animation="property:position; to: 0 -1 50; loop: true; dur: 60000">
        <a-entity 
          gltf-model="#model1" 
          animation-mixer 
          scale="3 3 3"
          rotation="0 0 0"  
          position="-3 1.2 0">
        </a-entity>
        <a-entity 
          gltf-model="#model2" 
          animation-mixer 
          scale="3 3 3"
          rotation="0 0 0"  
          position="3 1.2 -15">
        </a-entity>
</a-entity>

<a-entity 
  	gltf-model="#model3" 
  	animation-mixer 
  	scale="2.8 3 2.8"
  	rotation="0 0 0"  
  	position="15.30277 3.31358 14.2878"
  	animation="property: rotation; to: 0 -360 0; loop: true; easing: linear; dur: 10000">
</a-entity>

<a-entity 
  	gltf-model="#robot" 
  	animation-mixer 
  	scale="8 8 8"
  	rotation="0 -45 0"  
  	position="12.12169 2.7071 12.90204" 
  	>
</a-entity>

<!-- Models End -->


<!-- Video player -->

<a-assets>
  <video id="video-src" src="assets/intro.mp4" autoplay muted loop></video>
</a-assets>

<a-video id="video-screen" src="#video-src" position="0 4.5 -14" width="12" height="9" opacity="0.9"></a-video>

<!-- Video player End -->


</a-scene>


<!-- Video autoplay mobile devices -->

<script type="text/javascript">
  let scene = document.querySelector('a-scene');
  var videoEl = document.querySelector('#video-src');

  // Detect mobile device and add a user interaction fallback

  const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

  window.onload = function() {
    if (isMobile) {

  // For mobile devices, play video on user interaction

      document.body.addEventListener('touchstart', function() {
        videoEl.play();
      }, { once: true });
    } else {

  // Autoplay for non-mobile devices

      videoEl.play();
    }
  };
</script>

<!-- Video autoplay mobile devices End -->


<!-- Stop audio -->

<script>
  // Get all A-Frame entities with sounds (i.e., the entities for sounds 1 to 8)
  const soundEntities = [
    document.querySelector('#sound01'),
    document.querySelector('#sound02'),
    document.querySelector('#sound03'),
    document.querySelector('#sound04'),
    document.querySelector('#sound05'),
    document.querySelector('#sound06'),
    document.querySelector('#sound07'),
    document.querySelector('#sound08')
  ];

  // Function to stop all sounds with a fade-out effect
  function stopAllSounds() {
    soundEntities.forEach(soundEntity => {
      const soundComponent = soundEntity.components.sound;
      if (soundComponent && soundComponent.isPlaying) {
        fadeOutAndStop(soundComponent); // Apply fade-out before stopping
      }
    });
  }

  // Function to gradually lower the volume and then stop the sound
  function fadeOutAndStop(soundComponent) {
    let volume = soundComponent.volume; // Get the current volume
    const fadeDuration = 1000; // Fade-out duration in milliseconds
    const fadeStep = 50; // How often to lower the volume (milliseconds)
    const fadeAmount = volume / (fadeDuration / fadeStep); // Amount to decrease volume each step

    const fadeInterval = setInterval(() => {
      if (volume > 0) {
        volume -= fadeAmount; // Lower the volume
        if (volume < 0) volume = 0; // Ensure volume doesn't go below 0
        soundComponent.setVolume(volume); // Update the volume
      } else {
        clearInterval(fadeInterval); // Stop the fade effect
        soundComponent.stopSound(); // Stop the sound when the volume reaches 0
      }
    }, fadeStep);
  }

  // Add click event listeners to each plane
  soundEntities.forEach((soundEntity) => {
    soundEntity.addEventListener('click', () => {
      stopAllSounds(); // Stop all currently playing sounds with fade-out
      soundEntity.components.sound.playSound(); // Play the clicked sound
    });
  });
</script>

<!-- Stop audio End -->


<!-- HTML Overlay with iframe for Lightbox -->

    <div id="overlay">
      <span class="close-btn" onclick="closeOverlay()">&times;</span>
      <div class="iframe-container">
        <iframe id="lightbox-iframe" src="" allowfullscreen></iframe>
      </div>
    </div>

    <script src="assets/lightbox.js"></script>

<!-- HTML Overlay with iframe for Lightbox End -->


<!-- Disable Pointer Lock -->

<script>
      AFRAME.registerComponent('disable-pointer-lock', {
        init: function () {
          const plane = this.el;

          plane.addEventListener('click', function () {
            // Exit pointer lock when the plane is clicked
            if (document.pointerLockElement) {
              document.exitPointerLock();
            }

            // Optional: Disable pointer lock in the look-controls (for further safety)
            const cameraEl = document.querySelector('[camera]');
            const lookControls = cameraEl.components['look-controls'];
            if (lookControls) {
              lookControls.data.pointerLockEnabled = false;
              console.log('Pointer Lock Disabled');
            }
          });
        }
      });

      // Attach the component to the plane
      document.querySelector('#models').setAttribute('disable-pointer-lock', '');
</script>

  </body>
</html>